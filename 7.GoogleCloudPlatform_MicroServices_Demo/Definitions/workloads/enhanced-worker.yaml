# Code generated by KubeVela templates. DO NOT EDIT.
apiVersion: core.oam.dev/v1alpha2
kind: WorkloadDefinition
metadata:
  name: enhanced-worker
  annotations:
    definition.oam.dev/description: "Describes long-running, scalable, containerized services that running at backend."
spec:
  definitionRef:
    name: deployment.apps
  schematic:
    cue:
      template: |
        output: {
        	// Deployment
        	apiVersion: "apps/v1"
        	kind:       "Deployment"
        	metadata: {
        		name: context.name
        	}
        	spec: {
        		selector: matchLabels: {
        			"app": context.name
        		}
        		template: {
        			metadata: {
        				labels: {
        					"app": context.name
        				}
        			}
        			spec: {
        				serviceAccountName:            "default"
        				terminationGracePeriodSeconds: parameter.podShutdownGracePeriodSeconds
        				restartPolicy:                 "Always"
        				containers: [{
        					name:  context.name
        					image: parameter.image
        					if parameter.env != _|_ {
        						env: [
        							for k, v in parameter.env {
        								name:  k
        								value: v
        							},
        						]
        					}
        					resources: {
        						requests: {
        							if parameter.cpu != _|_ {
        								cpu: parameter.cpu
        							}
        							if parameter.memory != _|_ {
        								memory: parameter.memory
        							}
        						}
        					}
        				}]
        			}
        		}
        	}
        }
        parameter: {
        	image:                         string
        	podShutdownGracePeriodSeconds: *30 | int
        	env: [string]: string
        	cpu:    string
        	memory: string
        }
        
