# Code generated by KubeVela templates. DO NOT EDIT.
apiVersion: core.oam.dev/v1alpha2
kind: TraitDefinition
metadata:
  annotations:
    definition.oam.dev/description: "Create a LoadBalancer for the specified service"
  name: load-balancer
spec:
  appliesToWorkloads:
    - microservice
  schematic:
    cue:
      template: |-
        outputs: loadbalancer: {
        	apiVersion: "v1"
        	kind:       "Service"
        	metadata: {
        		name: context.name + "-external"
        	}
        	spec: {
        		type: "LoadBalancer"
        		selector: {
        			app: context.name
        		}
        		ports: [{
        			port: parameter.servicePort
        			if parameter.containerPort != _|_ {
        				targetPort: parameter.containerPort
        			}
        			if parameter.containerPort == _|_ {
        				targetPort: parameter.servicePort
        			}
        		}]
        	}
        }
        
        parameter: {
        	servicePort:    int
        	containerPort?: int
        }
        
